# ユニバーサル基板配線ツール 機能仕様書

## 1. アプリケーション概要
Reactベースで開発されたユニバーサル基板（蛇の目基板）の配線設計ツールを、単一のHTMLファイルに移植したもの。ブラウザのみで動作し、バックエンドやビルドプロセスを必要としない。

## 2. 基本機能

### 2.1 基板設定
*   **サイズ変更**: 横穴数（Width）と縦穴数（Height）を自由に設定可能（デフォルト: 40x30）。
*   **ピッチ調整**: 穴の間隔（ピッチ）をmm単位で設定可能（デフォルト: 2.54mm）。
*   **ズーム/パン**:
    *   マウスホイールによるズームイン・ズームアウト機能。
    *   画面中心を基準としたスケーリング。

### 2.2 表示設定
*   **表示モード切替**:
    *   **表面（Front）**: 部品面。通常の視点。
    *   **裏面（Back）**: 配線面（ハンダ面）。左右反転して表示され、部品は透過表示される。座標系も自動的に反転。
*   **ラベル表示**: 部品名（R1, C1など）の表示/非表示の切り替え。

### 2.3 ファイル操作
*   **保存（Save）**: 現在の設計データ（基板設定、部品、配線、状態）をJSONファイルとしてダウンロード保存。
*   **読み込み（Open）**: ローカルのJSONデータを読み込んで設計を復元。

## 3. 編集ツール

### 3.1 部品配置（Component Placement）
以下の5種類の部品をパレットから選択して配置可能。
*   **抵抗 (Resistor)**: リード線とカラーコード（装飾）付き。
*   **コンデンサ (Capacitor)**: 極性表示あり（青色）。
*   **IC (DIP)**: DIPパッケージ。ピン数に応じたサイズ可変。
*   **汎用部品 (General)**: ピン配置のみのシンプルな矩形。
*   **ピンヘッダ (Jumper)**: 1列のピンヘッダ。

**部品の操作**:
*   **移動**: ドラッグ＆ドロップでグリッド単位で移動。接続された配線は自動追従。
*   **回転**: 部品選択中に `R` キーまたは回転ボタンで90度ずつ回転。
*   **属性編集**: 選択部品の「名前（Name）」と「値（Value）」を編集可能。
*   **サイズ変更**: 配置前にパレット上でデフォルトサイズ（幅・高さ）を変更可能。配置済み部品は削除→再配置で対応。
*   **削除**: `Delete` キーまたは削除ボタン。

### 3.2 配線（Wiring）
*   **配線モード**: 始点クリック -> 終点クリックで配線を作成。
*   **マンハッタン配線**: 始点から終点まで `横移動 -> 縦移動` のL字型（Polyline）で自動的にルートを描画。
*   **色選択**: 6色（赤、黒、青、黄、緑、白）から選択可能。
*   **移動・変形**:
    *   **端点ドラッグ**: 配線の端点（始点または終点）をドラッグして接続先を変更可能。
    *   **グループ移動**: 同じグリッド穴に接続されている複数の配線端点を、まとめてドラッグ移動可能。
*   **削除**: 配線を選択して削除可能。

### 3.3 選択・操作（Selection & Interaction）
*   **選択**: マウスクリックで部品または配線を選択。
*   **配線選択の改善**: 透明なヒットボックスを設けることで、細い線でも容易に選択可能。
*   **右クリック**: ツール選択解除、ドラッグキャンセル。

## 4. 技術仕様
*   **構成**: 単一HTMLファイル（CSS/JS埋め込み）。
*   **描画**: SVG (Scalable Vector Graphics) による高精細描画。
*   **スタイリング**: Tailwind CSS (CDN版) を使用。
*   **依存ライブラリ**: なし（Vanilla JSのみ）。
*   **データ構造**:
    *   ステート管理: グローバルな `state` オブジェクトで一元管理。
    *   座標系: 論理グリッド座標（穴のインデックス）と画面ピクセル座標の変換システム。

## 5. ショートカットキー
*   `R`: 選択中の部品を回転 (Rotate)
*   `Delete` / `Backspace`: 選択中のアイテムを削除
*   `Esc`: 選択解除 / キャンセル
